---
title: "Midterm Report - Group 14"
author: "Alexander Williams (anw5ph), Kevin Cooper (kac4bh), and Brian Yoon (byy2yt)"

output: 
    html_document:
      number_sections: no
      toc: TRUE
      toc_depth: 4
      toc_float: true
      toc_collapsed: true
      theme: journal
      code_folding: show
---

```{r, include=FALSE}

library(tidyverse)
library(ggplot2)
library(scales)
library(dplyr)
library(RColorBrewer)
library(cowplot)

```

# Analyzing Trends Between a Student's Habits and their School Performance

## Introduction / Abstract

For the DS 2003 Midterm Project, we will be investigating the relationships of different variables in a dataset for Student Alcohol Consumption. This dataset was collected from a survey of students in math and Portuguese language courses in a secondary school in Portugal and contains a variety of variables ranging from demographics to drinking habits. We will use this dataset to to determine if there are any trends that we can identify regarding weekend drinking habits and frequency of going out for students, as well as, frequency of going out and the final grade the student received in the course. As the data is from two subjects in Portugal, the grading scales will be different, and since the legal drinking age is 18 there will be data with students drinking much younger than 21.

## Dataset Summary

We will be using two datasets for this report. They both come from the same source and have the same columns (variables). The difference between the two is that one (dfMath) is for students in a math course and the second (dfPort) is for students in a Portuguese course. We will use the two datasets to determine if the trends we observe for one course is also evident in the other course.

For the first question of the report, we are using the following columns (variables):

1. Walc - weekend alcohol consumption (factor: from 1 - very low to 5 - very high) 
2. goout - going out with friends (factor: from 1 - very low to 5 - very high)

For the second question of the report, we are using the following columns (variables): 

1. goout - going out with friends (factor: from 1 - very low to 5 - very high) 
2. G3_interval - final grade, G3 data seperated into quartiles (factor: 0-8, 9-10, 11-13, 14-20) 

Not used columns (variables):

1. school - student's school (binary: 'GP' - Gabriel Pereira or 'MS' - Mousinho da Silveira)
2. sex - student's sex (binary: 'F' - female or 'M' - male)
3. age - student's sex (binary: 'F' - female or 'M' - male)
4. address - student's home address type (binary: 'U' - urban or 'R' - rural)
5. famsize - family size (binary: 'LE3' - less or equal to 3 or 'GT3' - greater than 3)
6. Pstatus - parent's cohabitation status (binary: 'T' - living together or 'A' - apart)
7. Medu - mother's education (numeric: 0 - none, 1 - primary education (4th grade), 2 – 5th to 9th grade, 3 – secondary education or 4 – higher education)
8. Fedu - father's education (numeric: 0 - none, 1 - primary education (4th grade), 2 – 5th to 9th grade, 3 – secondary education or 4 – higher education)
9. Mjob - mother's job (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')
10. Fjob - father's job (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')
11. reason - reason to choose this school (nominal: close to 'home', school 'reputation', 'course' preference or 'other')
12. guardian - student's guardian (nominal: 'mother', 'father' or 'other')
13. traveltime - home to school travel time (numeric: 1 - <15 min., 2 - 15 to 30 min., 3 - 30 min. to 1 hour, or 4 - >1 hour)
14. studytime - weekly study time (numeric: 1 - <2 hours, 2 - 2 to 5 hours, 3 - 5 to 10 hours, or 4 - >10 hours)
15. failures - number of past class failures (numeric: n if 1<=n<3, else 4)
16. schoolsup - extra educational support (binary: yes or no)
17. famsup - family educational support (binary: yes or no)
18. paid - extra paid classes within the course subject (Math or Portuguese) (binary: yes or no)
19. activities - extra-curricular activities (binary: yes or no)
20. nursery - attended nursery school (binary: yes or no)
21. higher - wants to take higher education (binary: yes or no)
22. internet - Internet access at home (binary: yes or no)
23. romantic - Internet access at home (binary: yes or no)
24. famrel - quality of family relationships (numeric: from 1 - very bad to 5 - excellent)
25. freetime - free time after school (numeric: from 1 - very low to 5 - very high)
26. absences - number of school absences (numeric: from 0 to 93)
27. health - current health status (numeric: from 1 - very bad to 5 - very good)
28. G1 - first period grade (numeric: from 0 to 20)
29. G2 - second period grade (numeric: from 0 to 20)
30. G3 - final grade (numeric: from 0 to 20, output target)
31. Dalc - daily alcohol consumption (factor: from 1 - very low to 5 - very high)

```{r}
# Load the dataset
getwd()
setwd("C:/Users/brian/OneDrive/Desktop/0- Spring 2023 S8/DS2003/Midterm Project")
dfMath <- read.csv('student-mat.csv')
dfPort <- read.csv('student-por.csv')


```

## Question 1

### Question
In this sample population, does the frequency a student goes out have a relationship with the level of weekend alcohol consumption? 

### Prediction
We predict that number of students who have the highest weekend alcohol consumption will go out more, and the number students who have the least weekend alcohol consumption will go out less.

### Chart & Chart Caption{.tabset}
#### Math Graph
```{r}
dfMath$goout <- factor(dfMath$goout, levels = c("1", "2", "3","4", "5"), 
                       ordered= TRUE)
dfMath$Walc <- factor(dfMath$Walc, levels = c("1", "2", "3","4", "5"), 
                       ordered= TRUE)

mathPlot <- ggplot(dfMath, aes(x = goout, y = after_stat(count), fill = Walc)) +
  geom_bar(aes(y = (after_stat(count))/sum(after_stat(count))), 
           position = position_dodge(), color = "black") + 
  scale_y_continuous(labels = scales::percent,
   limits = c(0,0.15)) +
  scale_fill_brewer(palette="Spectral", direction=-1) +
  theme_bw() +
  xlab(label='Frequency of Going Out') +
  ylab(label='Percentage') +
  labs(title = "The Percentage of how Often Math Students Go Out",
       subtitle = "Separated by the Students' Weekend Alcohol Consumption") +
  facet_grid(.~Walc)

mathPlot
```

**Figure 1. Faceted bar chart that displays the frequency a math student goes out on the x-axis and the percentage of students who go out respectively on the y-axis, the coloring of the bars correlates to the amount of alcohol the student reported to drinking during the weekend.**


#### Portuguese Graph
```{r}

dfPort$goout <- factor(dfPort$goout, levels = c("1", "2", "3","4", "5"), 
                       ordered= TRUE)
dfPort$Walc <- factor(dfPort$Walc, levels = c("1", "2", "3","4", "5"), 
                       ordered= TRUE)

portPlot <- ggplot(dfPort, aes(x = goout, y = after_stat(count), fill = Walc)) +
  geom_bar(aes(y = (after_stat(count))/sum(after_stat(count))), 
           position = position_dodge(), color = "black") + 
  scale_y_continuous(labels = scales::percent,
   limits = c(0,0.15)) +
  scale_fill_brewer(palette="Spectral", direction=-1) +
  theme_bw() +
  xlab(label='Frequency of Going Out') +
  ylab(label='Percentage') +
  labs(title = "The Percentage of how Often Portuguese Students Go Out",
       subtitle = "Separated by the Students' Weekend Alcohol Consumption") +
  facet_grid(.~Walc)

portPlot

```

**Figure 2. Faceted bar chart that displays the frequency a Portuguese student goes out on the x-axis and the percentage of students who go out respectively on the y-axis, the coloring of the bars correlates to the amount of alcohol the student reported to drinking during the weekend.**

### Discussion

We constructed a bar chart that had the number of times a student goes out on the x-axis and the percent of students that go out that many times on the y-axis. Additionally, we separated each bar by the level of weekend alcohol consumption. From there, we faceted the graph by weekend alcohol consumption so that we could more easily analyze the relationship between going out and the number of students who go out that much for a particular level of weekend alcohol consumption. 

Looking at the data of both the math and Portuguese, the lowest level of weekend alcohol consumption seems to have a left-skewed normal curve based on the number of times a student goes out. The second lowest level and the medium level of weekend alcohol consumption seem to have a more normal curve based on the number of times a student goes out. The two highest levels of weekend alcohol consumption seems to have a linearly increasing trend as a student goes out more. 

The trends and distributions for going out and weekend alcohol consumption are very similar in both graphs. For the students that drink more alcohol there is a positive linear relationship with the percentage of students and the students who go out more often. Focusing on the charts with a lower alcohol consumption, there is an increase of percentage versus how often the students went out until 3 nights, and then the trend became negative, signifying a normal-curved relationship. The normal trend for the lower levels is understandable in contrast to linear trend of the high levels of alcohol consumption because the students who do not drink as much go out for reasons other than to drink. 

### Chart Justification

We decided to answer our question by using bar charts that were differentiated and faceted by the level of weekend alcohol consumption because we thought that it would be the best strategy for visualizing the trends for the varying levels of weekend alcohol consumption based on the number of students and the frequency they went out with friends by being able to view each trend separately. Weaknesses of using this approach could be that bar charts are easily able to be modified to promote false information so it is important that the chart is created correctly and appropriately. 

## Question 2

### Question

In this sample, does the frequency that a student go out have a relationship with the final grade they received in the course?

### Prediction
We predict that students who go out more will receive a lower final grade and students who go out less will receive a higher final grade. Therefore, there will be a negative correlation with the frequency a student goes out and the final grade they received. 

### Chart & Chart Caption{.tabset}
#### Math Percentage Graph
``` {r}

dfMath$G3 <- factor(dfMath$G3, levels=c("0", "1", "2", "3","4", "5", "6", "7", "8", "9", "10",
                                  "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"), 
                 ordered= TRUE)
dfMath$goout <- factor(dfMath$goout, levels=c("1", "2", "3", "4", "5"), ordered=TRUE)

dfMath$G3_interval <-fct_collapse(
  dfMath$G3, 
  "0-8" = c("0", "1", "2", "3", "4", "5", "6", "7", "8"), 
  "9-10" = c("9", "10"), 
  "11-13" = c("11", "12", "13"), 
  "14-20" = c("14", "15", "16", "17", "18", "19", "20"))

percMath <- ggplot(dfMath, aes(x=goout, y=after_stat(count), fill=G3_interval)) +
  geom_bar(aes(y = after_stat(count)/sum(after_stat(count))),
           position=position_dodge(), 
           color="black") +
  scale_y_continuous(labels = scales::percent,
   limits = c(0,0.15)) +
  scale_fill_brewer(palette="Spectral", direction=-1) +
  theme_bw() +
  xlab(label='Frequency of Going Out') +
  ylab(label='Percentage') +
  labs(title='The Percentage of How Often Math Students Go Out', subtitle = "Separated by the Students' Final Course Grade") +
  facet_grid(.~G3_interval)

percMath

```

**Figure 3. Faceted bar chart that displays the frequency a math student goes out on the x-axis and the percentage of students who go out respectively on the y-axis, the coloring of the bars correlates to the interval that their final grade in the math course falls into.**

#### Math Count Graph
```{r}

dfMath$G3 <- factor(dfMath$G3, levels=c("0", "1", "2", "3","4", "5", "6", "7", "8", "9", "10",
                                  "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"), 
                 ordered= TRUE)
dfMath$goout <- factor(dfMath$goout, levels=c("1", "2", "3", "4", "5"), ordered=TRUE)

dfMath$G3_interval <-fct_collapse(
  dfMath$G3, 
  "0-8" = c("0", "1", "2", "3", "4", "5", "6", "7", "8"), 
  "9-10" = c("9", "10"), 
  "11-13" = c("11", "12", "13"), 
  "14-20" = c("14", "15", "16", "17", "18", "19", "20"))

countMath <- ggplot(dfMath, aes(x=goout, y=after_stat(count), fill=G3_interval)) +
  geom_bar(stat='count', position=position_dodge(), color = "black") +
  scale_fill_brewer(palette="Spectral", direction=-1) +
  scale_y_continuous(limits = c(0,80)) +
  theme_bw() +
  xlab(label='Frequency of Going Out') +
  ylab(label='Count') +
  labs(title='The Count of how Often Math Students Go Out', subtitle = "Separated by the Students' Final Course Grade") +
  facet_grid(.~G3_interval)

countMath
```

**Figure 4. Faceted bar chart that displays the frequency a math student goes out on the x-axis and the count of students who go out that much on the y-axis, the coloring of the bars correlates to the interval that their final grade in the math course falls into.**

#### Portuguese Percentage Graph
``` {r}

dfPort$G3 <- factor(dfPort$G3, levels=c("0", "1", "2", "3","4", "5", "6", "7", "8", "9", "10",
                                  "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"), 
                 ordered= TRUE)

dfPort$goout <- factor(dfPort$goout, levels=c("1", "2", "3", "4", "5"), ordered=TRUE)

dfPort$G3_interval <-fct_collapse(dfPort$G3, "0-10" = c("0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10"), "11-12" = c("11", "12"), "13-14" = c("13", "14"), "15-20" = c("15", "16", "17", "18", "19", "20"))

percPort <- ggplot(dfPort, aes(x=goout, y=after_stat(count), fill=G3_interval)) +
  geom_bar(aes(y = (after_stat(count))/sum(after_stat(count))), position=position_dodge(), 
           color="black") +
  scale_y_continuous(labels = scales::percent,
   limits = c(0,0.15)) +
  scale_fill_brewer(palette="Spectral", direction=-1) +
  theme_bw() +
  xlab(label='Frequency of Going Out') +
  ylab(label='Percentage') +
  labs(title='The Percentage of how Often Portuguese Students Go Out', subtitle = "Separated by the Students' Final Course Grade") +
  facet_grid(.~G3_interval)

percPort

```

**Figure 5. Faceted bar chart that displays the frequency a Portuguese student goes out on the x-axis and the percentage of students who go out that much on the y-axis, the coloring of the bars correlates to the interval that their final grade in the Portuguese course falls into.**

#### Portuguese Count Graph
```{r}

dfPort$G3 <- factor(dfPort$G3, levels=c("0", "1", "2", "3","4", "5", "6", "7", "8", "9", "10",
                                  "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"), 
                 ordered= TRUE)

dfPort$goout <- factor(dfPort$goout, levels=c("1", "2", "3", "4", "5"), ordered=TRUE)

dfPort$G3_interval <-fct_collapse(dfPort$G3, "0-10" = c("0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10"), "11-12" = c("11", "12"), "13-14" = c("13", "14"), "15-20" = c("15", "16", "17", "18", "19", "20"))

countPort <- ggplot(dfPort, aes(x=goout, y=after_stat(count), fill=G3_interval)) +
  geom_bar(stat='count', position=position_dodge(), color="black") +
  scale_fill_brewer(palette="Spectral", direction=-1) +
  scale_y_continuous(limits = c(0,80)) +
  theme_bw() +
  xlab(label='Frequency of Going Out') +
  ylab(label='Count') +
  labs(title='The Count of how Often Portuguese Students Go Out', subtitle = "Separated by the Students' Final Course Grade") +
  facet_grid(.~G3_interval)

countPort
```

**Figure 6. Faceted bar chart that displays the frequency a Portuguese student goes out on the x-axis and the count of students who go out that much on the y-axis, the coloring of the bars correlates to the interval that their final grade in the Portuguese course falls into.**

### Discussion

We constructed bar charts for the math and Portuguese classes which portrays the frequency (0-5) a student goes out on the x-axis and the percentages and counts of students that go out at that frequency on the y-axis. Additionally, we separated each chart by the final grades the students received in the course by quartiles. Each quartile contains a similar number of students. From there, we faceted the graph by their final grade so that we could more easily analyze the relationship between the frequency of going out and the final grade received. 

The charts of the percentage of how often math students go out related to their final grade in the course divides the class into four quartiles of almost equivalent numbers of students. There are 395 students enrolled in the math class, and the quartiles are divided as such: 0-8: 102 students; 9-10: 84 students; 11-13: 109 students; 14-20: 100 students. As pictured, it can be seen that the charts shift from a left skewed graph for the students who received a grade in the lowest quartile (0-8), to a more right skewed graph in the highest quartile (14-20). With this selection of data, a left skewed graph can be interpreted as such: students who go out more receive will receive lower final grades in the math class. On the other hand, a right skewed graph correlates to a higher percentage of students who go out less receiving higher final grades than those who respond that they go out less. The second graph displays the same information, just with counts instead of a percentage. It can be seen that each quartile contains about the same number of students, reinforcing the validity of the percentage charts.

For the Portuguese class, the premise of the charts are exactly the same as the charts for the math class. The differences in the data are that the Portuguese class is taken by 649 students, and the grade distribution is a lot different. As a result, the quartiles are marked by different scores in the class, and they contain a wider range of students leading to a more siginifcant difference in the numbers in each quartile. The quartiles are divided as such: 0-10: 197 students; 11-12: 176 students; 13-14: 145 students; 15-20: 131 students. The skew trends follow just as the math class, however, the skews are less extreme. The second and third quartiles of grades of 11-14 are mostly normal, while the first (0-10) and fourth (15-20) quartiles are more left and right skewed, respectively. Thus, it can be inferred that students who go out more receive lower grades in the class on average.

It can be inferred from both groups of charts that students who go out more often receive lower grades on average than their peers who go out less and receive higher grades in the class. Both groups of charts portray a shift from left skewed to right skewed. The difference in how the quartiles are divided may be attributed to the level of difficulty of the class. Students on average received higher grades in the Portuguese class compared to the math class, and this lessened degree of difficulty may explain the less extreme skews in its graphs. 

### Chart Justification

We decided to answer our question by using bar charts that were differentiated and faceted by the final course grade because we thought that it would be the best strategy for visualizing the trends for the various intervals of final grades based on the number of students and the frequency they went out with friends by being able to view each trend separately. Weaknesses of using this approach could be that bar charts are easily able to be modified to promote false information so it is important that the chart is created correctly and appropriately. 

## Conclusion

Both of our questions concern the students' levels of going out and drinking while also cross-referencing this information with the grades they received in two different classes. This information is directly relevant to us and our peers, as much of college is balancing a social life with an extremely rigorous academic life. While these students do not attend school in the United States, the trends and relations can be attributed to any student. The first question with its graphs discover that the students that go out at a higher frequency tend to drink more on average compared to those who go out at a lesser frequency. Moving to the second question, we found that students who go out more receive lower grades on average. Combining the interpretations from the two questions, it can be loosely inferred that the students drinking more will receive lower grades in the two classes. It is a strong possibility that the same is true for any student, so a recommendation for students looking to receive higher grades in their classes is to go out less and drink less, as a heightened social life may negatively affect a student's academic performance. 
